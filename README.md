# JuroSpring Market
------------
### 왜 이런 프로젝트를 기획하였나요?
> **[ 대량의 데이터 ]** 를 가지고<br/>
> **[ 초기 데이터 적재부터 단순조회 및 활용까지 전 과정 ]** 을 다뤄보고자<br/>
> **[ 대중들에게 가장 익숙하고 의미있는 쇼핑데이터 ]** 를 이용한 프로젝트<br/>
------------
### 어떤 기술을 사용하였나요?
> **[ 크롤링 및 API ]**
+ [ Selenium ] 
  + 브라우저를 통해 직접 해당 페이지로 접근하는 방식으로 가장 인간의 활동과 유사
  + AWS 프리티어 메모리로는 급격한 성능저하 발생으로 **사용불가**
+ [ Jsoup ] 
  + 적은 메모리로도 사용가능
  + 이미지 로딩 불가 & 지속적인 호출 시 IP차단되거나 500번 503번 서버에러 발생 등으로 데이터 적재 로직의 **안정성 저하 우려**
+ **[ API ]** 
  + 적은 메모리로도 사용가능
  + 이미지를 포함한 상품의 모든 상세정보를 가져올 수 있으면서 최소한의 서버부하로 해결가능 **=> PICK**
> **[ 스프링 배치 ]**
+ **[ Chunk ]** 
  + Tasklet 방식은 tasklet 전체가 트랜잭션으로 다뤄져서 완료되지 않는 이상 DB에 적재하지 않음
  + Chunk방식은 유연한 트랜잭션 관리를 제공해서 페이지 1단위씩 트랜잭션을 구성하여 <br/>
  언제라도 interrupt가 발생하면 이전 페이지까지는 DB에 적재
+ **[ 멀티쓰레드 ]** 
  + API방식을 채택하여 메모리가 부족하지 않은 환경에서 멀티쓰레드를 적용하여 대량의 데이터를 단시간내에 적재
+ **[ 재시도 및 알림 ]**
  + API 호출 시 제대로 된 데이터를 받지 못했을 경우 3번 재시도 <br/>
  => chunk단위가 실패하면 Decider를 설정하여 해당 chunk 3번 재시도 <br/>
  => 모두 실패 시 Slack 알림 띄우도록 설계하여 안정성 보장
+ **[ DB Connection ]** 
  + DB Connection open시 list형태로 트랙킹하고 배치종료 전 DB Connection 모두 close
> **[ ES, Logstash, RDB ]**
+ **[ ES ]** 
  + 최소 몇 백만 건 이상의 대규모 데이터를 가지고 실시간 검색 및 통계작업에 적합
  + 한국어 검색이 용이하도록 한국어형태소 분석기 Nori와 문자열을 잘라서 찾아내는 nGram 활용
  + 최소한의 검색연관도를 보장하기 위해 min_score : 20을 부여하여 질의
  + 메모리 부족으로 인한 성능저하 방지를 위해 최대 result 반환수를 800개로 한정
+ **[ RDB ]** 
  + 데이터의 일관성 및 무결성 보장, 정형화된 관계파악에 적합
+ **[ Logstash ]** 
  + RDB와 ES간의 동기화
  + schedule에 cron 표현식으로 10초마다 SELECT 문 실행하게 설정
  + statement에 SELECT 할 때 MySQL의 timeStamp를 tracking_column으로 설정하고 <br/>WHERE 조건에 이전에 적재한 timeStamp 값을 :sql_last_value 파라미터로 받아 활용하여 <br/>데이터가 누락되거나 중복되지 않게 적재
+ **[ 데이터 흐름 ]** 
  + 스프링 배치 => RDB 데이터 적재 => Logstash => ES 데이터 적재
> **[ Jenkins ]**
+ **[ CI/CD ]** 
  + gitHub 커밋 => Webhooks를 이용해 Jenkins로 보냄 => Jenkins에서 빌드 후 AWS 인스턴스에 접근해서 배포
+ **[ Build Periodically ]** 
  + 매일 00:00 모든 배치서버 STOP <br/>=> 00:10 Logstash 메모리 부족으로 인한 성능저하 방지를 위해 재시작 <br/>=> 01:00 모든 배치서버 자동시작
+ **[ 복호화 ]** 
  + git-secret을 이용해 GPG 알고리즘(RSA 기반)으로 암호화된 파일을 PrivateKey를 credential로 저장 후 application.yml을 복호화
> **[ 스프링 ]**
+ **[ 보안 ]** 
  + 보안측면에서 유리한 세션 방식으로 로그인 정보 저장
  + 백엔드 서버에 요청 시 인터셉터 이용해서 세션을 통한 로그인 검증
  + 비밀번호 저장 시 랜덤한 4자리의 Salt 값 생성 후 (비밀번호 + Salt)를 단방향암호화 진행
  + SQL Injection 방지를 위해 myBatis #{} 바인딩 방식 사용
------------
### 프로젝트는 어떤 서비스를 제공하나요?
+ 하루 최대 **100만건** 적재 가능한 서비스 구현(중복데이터 없고 20쓰레드 15시간 작동 및 API 호출 간 1초 Thread.sleep 기준)
+ **문자메시지 전송서비스**를 통해 특정 검색어에 해당하는 제품이 설정한 가격 이하라면 알림 제공
+ 어떠한 검색어든 가격 및 판매상품 개수 추이를 **시계열로 검색** 가능
------------
### 추후 운영서비스로 발전한다면 추가하고 싶은 부분이 있나요?
+ 서버 성능저하 방지를 위해 권한검증방식을 기존의 세션방식에서 **JWT 방식**으로 변경 및 **로드밸런싱** 적용, **크롤링IP 감지&차단**
+ 적재된 데이터를 제공할 수 있는 **OPEN API 및 API 명세서** 제공
+ 적재된 데이터를 활용한 **빅데이터분석 및 문서화** 구현
------------
### 프로젝트 설치 및 실행방법은 어떻게 되나요?
> 서버 설정 및 개인정보를 application.yml에 포함하고 있어서 현재 GIT에 올린 버전은 모두 **git-secret을 이용해 암호화**한 상태입니다.<br/>그러므로 로컬에서 실행하는 것이 아닌 **하단의 주소를 통해 서버에 접속**하여 확인해주세요.
------------
### 프로젝트 주소 및 스크린샷을 첨부해주세요.
+ **주소 : https://www.juroSpring.o-r.kr**
+ 스크린샷
  + 검색화면
    <img width="901" alt="화면 캡처 2023-07-12 172721" src="https://github.com/ParkSungCheol/ShoppingMall_vue/assets/93702296/6beb4687-8c34-4db0-85fd-f66d3fbf69a0">
  + 통계화면(시계열검색)
    <img width="904" alt="화면 캡처 2023-07-12 172846" src="https://github.com/ParkSungCheol/ShoppingMall_vue/assets/93702296/dbfea2eb-c336-478f-9aa9-8701d9830349">
  + 문자메시지 전송시스템
    <img width="914" alt="화면 캡처 2023-07-12 172920" src="https://github.com/ParkSungCheol/ShoppingMall_vue/assets/93702296/f31d9f9f-78bd-4085-908a-0bf091a76054">
------------
### 현재 데이터 적재 대상 검색어를 알려주세요.
> [ 냉동식품, 노트북, 니트, 당면, 도장, 드레스, 라면, 램프, 런닝머신, 레고, 레깅스, 레이저 포인터, 로봇청소기, 로션, 롤러스케이트, 롱패딩, 리본, 립스틱, 마그네슘, 마그네틱 보드, 마사지기, 마스카라, 마스크팩, 마이크, 마카, 만화책, 망치, 망토, 맨투맨, 머그잔, 머리핀, 먼지청소기, 먼지털이 도구, 모니터, 모자, 목걸이, 물티슈, 바둑, 바디크림, 바이올린, 바지락, 반바지, 반지, 배드민턴, 보드게임, 부채, 브러시, 비니, 비치볼, 비타민, 빗자루, 빵가루, 사운드바, 사이렌, 사진액자, 삼계탕, 상품권, 색소폰, 색연필, 색종이, 색칠북, 샌드위치, 샌들, 샐러드, 샤베트, 샤워가운, 샤워기, 샤워젤, 샴페인, 샴푸, 샹들리에, 서랍장, 서핑, 선글라스, 선반, 선크림, 선풍기, 설탕, 세라믹 페인트, 셔츠, 소독제, 소설, 손목보호대, 쇼파, 수영, 수첩, 스커트, 스쿠터, 스탠드, 스테이플러, 스티커, 스폰지, 스프레이, 스피커, 슬랙스, 슬리퍼, 시계, 식기세척기, 식물 영양제, 식이섬유, 식탁보, 식품포장기, 신발 끈, 신발장, 쓰레받기, 아기수유용품, 아기욕조, 아기용품, 아이스티, 악기, 안마의자, 안전벨트, 양말, 에어컨, 옷걸이, 우유, 운동화, 원피스, 유화 물감, 음료수, 의자, 이어폰, 이유식, 인덕션, 인테리어소품, 인형, 입냄새제거, 자동차 모형, 자물쇠, 자석, 자외선차단제, 자전거, 자켓, 장갑, 장난감, 전기그릴, 전기면도기, 전기밥솥, 전기포트, 전자도어락, 전자드럼, 점퍼, 정리함, 정장, 조명, 종이백, 종이컵, 지갑, 책상, 천막, 체중계, 축구, 침구, 침대, 침대매트, 칫솔, 카레, 카메라, 카시트, 캐리어, 커피, 컴퍼스, 케이블, 케이크, 코트, 콘서트, 쿠션, 클라리넷, 클러치 백, 클렌징폼, 클립, 키링, 키보드, 키캡, 킥보드, 타올, 탁구, 탁자, 탄산음료, 탕수육, 태블릿, 탬버린, 터치스크린, 턱걸이기구, 턱시도, 텀블러, 테니스, 테이블, 테이프, 텐트, 투명필름, 퍼즐, 펜, 포스트잇, 포크, 피아노, 핸드크림, 헤드셋, 황사마스크, 휴대폰 ]<br/>
**총 200개 검색어 * 개당 5,000건 데이터 적재 = 하루 최대 1,000,000건 적재**
------------
